import geopandas as gpd
from shapely.geometry import Polygon, Point
import numpy as np
import json

# polygon coordinates
polygon_coords = [ [77.5368254, 12.9350652 ], [ 77.5366736, 12.9351499 ], [ 77.5365472, 12.9352203 ], [ 77.5364224, 12.9352904 ], [ 77.5362404, 12.9353927 ], [ 77.536214, 12.9354065 ], [ 77.5357192, 12.9356587 ], [ 77.5350777, 12.9359811 ], [ 77.5345084, 12.936269 ], [ 77.5342956, 12.9364664 ], [ 77.5339084, 12.9359767 ], [ 77.5336498, 12.9350565 ], [ 77.5330958, 12.935089 ], [ 77.5334544, 12.934225 ], [ 77.533432, 12.9341912 ], [ 77.5334298, 12.9341879 ], [ 77.5334476, 12.9341866 ], [ 77.5335135, 12.9341555 ], [ 77.5335474, 12.9340908 ], [ 77.5335748, 12.9340069 ], [ 77.5335956, 12.9339051 ], [ 77.5336607, 12.9336233 ], [ 77.5336949, 12.9335348 ], [ 77.533735, 12.9334554 ], [ 77.533757, 12.9334123 ], [ 77.5337859, 12.9333092 ], [ 77.5338158, 12.9332468 ], [ 77.5338522, 12.9332024 ], [ 77.5338929, 12.9331817 ], [ 77.5339805, 12.9331424 ], [ 77.5340979, 12.9330735 ], [ 77.5341326, 12.9330405 ], [ 77.5341519, 12.9330132 ], [ 77.5341634, 12.9329521 ], [ 77.5341683, 12.9328673 ], [ 77.5341673, 12.9327713 ], [ 77.5341444, 12.9326078 ], [ 77.5341523, 12.9325377 ], [ 77.5341643, 12.9324676 ], [ 77.5341601, 12.9323999 ], [ 77.5341602, 12.9323221 ], [ 77.5341602, 12.932069 ], [ 77.5341685, 12.9319968 ], [ 77.5341761, 12.9319299 ], [ 77.5341769, 12.9316667 ], [ 77.5341771, 12.9316632 ], [ 77.5341829, 12.9315142 ], [ 77.5341734, 12.9312924 ], [ 77.5341731, 12.9312851 ], [ 77.5341672, 12.9308198 ], [ 77.5341659, 12.9306855 ], [ 77.5342407, 12.9304058 ], [ 77.5345036, 12.9299808 ], [ 77.534665, 12.9297771 ], [ 77.5347682, 12.9296121 ], [ 77.5347794, 12.9295942 ], [ 77.5348701, 12.9293415 ], [ 77.534878, 12.9293199 ], [ 77.5350516, 12.9292347 ], [ 77.5349248, 12.9287062 ], [ 77.5348907, 12.9284096 ], [ 77.5348821, 12.928072 ], [ 77.5349004, 12.9278301 ], [ 77.5349206, 12.9277142 ], [ 77.534939, 12.9276084 ], [ 77.5350556, 12.9273502 ], [ 77.5350696, 12.9273191 ], [ 77.5352483, 12.9271661 ], [ 77.5354684, 12.9270736 ], [ 77.5356081, 12.9270553 ], [ 77.5360868, 12.9269185 ], [ 77.5366112, 12.9267895 ], [ 77.5366507, 12.9267798 ], [ 77.5368912, 12.926765 ], [ 77.5368914, 12.9267631 ], [ 77.5369069, 12.9265559 ], [ 77.5369066, 12.9265544 ], [ 77.5369001, 12.9265275 ], [ 77.5368715, 12.9264076 ], [ 77.5368528, 12.9263294 ], [ 77.5367992, 12.9262345 ], [ 77.5367538, 12.9261542 ], [ 77.5367078, 12.9259983 ], [ 77.53669, 12.925938 ], [ 77.5366757, 12.9258311 ], [ 77.5366613, 12.9257242 ], [ 77.5366508, 12.9256459 ], [ 77.5366423, 12.925323 ], [ 77.5367397, 12.9247585 ], [ 77.5368051, 12.9246212 ], [ 77.5367191, 12.9242595 ], [ 77.5366828, 12.923973 ], [ 77.5367426, 12.9236788 ], [ 77.5369015, 12.9235067 ], [ 77.5370487, 12.9234364 ], [ 77.537293, 12.9234024 ], [ 77.5374907, 12.9234784 ], [ 77.5376433, 12.923547 ], [ 77.5378087, 12.9236244 ], [ 77.5379711, 12.9237425 ], [ 77.5381452, 12.9239407 ], [ 77.5382521, 12.9240876 ], [ 77.5383145, 12.9241729 ], [ 77.5383547, 12.9242707 ], [ 77.5383807, 12.9243394 ], [ 77.5384172, 12.9243661 ], [ 77.5385107, 12.9244443 ], [ 77.5385782, 12.9245136 ], [ 77.5386933, 12.9246299 ], [ 77.538771, 12.9246789 ], [ 77.5388688, 12.9247276 ], [ 77.5389679, 12.9246826 ], [ 77.5391475, 12.9246267 ], [ 77.5393117, 12.924581 ], [ 77.5394151, 12.9245642 ], [ 77.539572, 12.9245344 ], [ 77.5396801, 12.9245198 ], [ 77.5397179, 12.9245003 ], [ 77.5399485, 12.9243659 ], [ 77.5401258, 12.9242512 ], [ 77.5402285, 12.9241588 ], [ 77.5402547, 12.9241359 ], [ 77.5402763, 12.9240499 ], [ 77.5402661, 12.9239562 ], [ 77.5402721, 12.9238026 ], [ 77.5402917, 12.923467 ], [ 77.5402439, 12.9232371 ], [ 77.5401583, 12.9230637 ], [ 77.5402949, 12.9230446 ], [ 77.5403761, 12.9231036 ], [ 77.5404319, 12.9232093 ], [ 77.5404695, 12.9231197 ], [ 77.5407626, 12.9230174 ], [ 77.5409579, 12.9229681 ], [ 77.5412647, 12.9237692 ], [ 77.541597, 12.9249699 ], [ 77.5416217, 12.9249651 ], [ 77.5418473, 12.9257015 ], [ 77.5419619, 12.9261566 ], [ 77.5422635, 12.9261029 ], [ 77.5423247, 12.9263078 ], [ 77.5421156, 12.9263571 ], [ 77.5421865, 12.9268065 ], [ 77.5422606, 12.9272442 ], [ 77.5423287, 12.9276437 ], [ 77.5423396, 12.9278626 ], [ 77.5420302, 12.9279951 ], [ 77.5419318, 12.9280316 ], [ 77.5419297, 12.9280362 ], [ 77.5418061, 12.9281187 ], [ 77.5417425, 12.9282051 ], [ 77.5416878, 12.9282599 ], [ 77.5417318, 12.9285079 ], [ 77.5414422, 12.9285649 ], [ 77.5415592, 12.9290268 ], [ 77.5416789, 12.9296513 ], [ 77.5419731, 12.9295942 ], [ 77.5420368, 12.9295168 ], [ 77.5421084, 12.9296539 ], [ 77.5427116, 12.9290766 ], [ 77.5430321, 12.9291231 ], [ 77.5430324, 12.9291242 ], [ 77.5430573, 12.9292223 ], [ 77.5431503, 12.929594 ], [ 77.5432481, 12.9299861 ], [ 77.543364, 12.9304481 ], [ 77.5433944, 12.9305704 ], [ 77.5430859, 12.930846 ], [ 77.5428685, 12.9310389 ], [ 77.5424839, 12.9313815 ], [ 77.5415873, 12.9320283 ], [ 77.5410786, 12.9323958 ], [ 77.5404332, 12.9328436 ], [ 77.539665, 12.9333819 ], [ 77.5394271, 12.933548 ], [ 77.5392515, 12.9336581 ], [ 77.5392332, 12.9336695 ], [ 77.5391812, 12.9337017 ], [ 77.5390123, 12.9337993 ], [ 77.5388905, 12.9338745 ], [ 77.5388876, 12.9338762 ], [ 77.5387634, 12.933952 ], [ 77.5382112, 12.9342738 ], [ 77.5380166, 12.9343873 ], [ 77.537613, 12.9346171 ], [ 77.5373463, 12.9347699 ], [ 77.5371048, 12.9349077 ], [ 77.5370493, 12.9349399 ], [ 77.5368254, 12.9350652 ]
]
polygon = Polygon(polygon_coords)

# bounding box
minx, miny, maxx, maxy = polygon.bounds

# grid of points with a spacing of ~0.0004 degrees (~40â€“50m)
step = 0.00083
points = []
for lat in np.arange(miny, maxy, step):
    for lon in np.arange(minx, maxx, step):
        p = Point(lon, lat)
        if polygon.contains(p):
            points.append((lat, lon))


print(f"Generated {len(points)} points inside the ward polygon.")
with open("coordinates.txt", "w") as f:
    for lat, lon in points:
        f.write(f"{lat}, {lon}\n")


# GeoJSON creation
features = []
for lat, lon in points:
    features.append({
        "type": "Feature",
        "geometry": {
            "type": "Point",
            "coordinates": [lon, lat]  
        },
        "properties": {}
    })

geojson_data = {
    "type": "FeatureCollection",
    "features": features
}

with open("hosakerahalli_grid_points.geojson", "w") as f:
    json.dump(geojson_data, f)

print("GeoJSON file saved as 'hosakerahalli_grid_points.geojson'")